<template>  <div class="block">    <vue-particles      color="#fff"      :particleOpacity="0.7"      :particlesNumber="60"      shapeType="circle"      :particleSize="4"      linesColor="#fff"      :linesWidth="1"      :lineLinked="true"      :lineOpacity="0.4"      :linesDistance="150"      :moveSpeed="2"      :hoverEffect="true"      hoverMode="grab"      :clickEffect="true"      clickMode="push"      class="particle">    </vue-particles>    <div class="loginBox">      <div class="logo">        <h1>云链运营管理后台</h1>        <p class="mgt10">基于区块链技术、去中心化数字资源分发交易网络</p>      </div>      <el-form ref="cloudChain" :model="form" class="form" :rules="cloudChain">        <p>登录</p>        <el-form-item prop="account">          <el-input v-model="form.account" placeholder="账号或手机号" @keyup.enter.native="submitForm('cloudChain')"                    @input="limitValue">            <i slot="prefix" class="el-input__icon el-icon-user"></i>          </el-input>        </el-form-item>        <el-form-item prop="password">          <el-input v-model="form.password" placeholder="密码" show-password                    @keyup.enter.native="submitForm('cloudChain')">            <i slot="prefix" class="el-input__icon el-icon-key"></i>          </el-input>        </el-form-item>        <el-form-item label="自动登录">          <el-switch v-model="form.delivery" @change="change"></el-switch>        </el-form-item>        <el-form-item>          <el-button type="primary" @click="submitForm('cloudChain')">登录</el-button>        </el-form-item>        <!--@click="submit('cloudChain')"-->      </el-form>    </div>    <div class="footer">      <p>copyright 2018 云链CSDC开发团队出品</p>    </div>  </div></template><script>	import Cookies from 'js-cookie'	export default {		data() {			let checkName = (rule, value, callback) => {				if (!value) {					return callback(new Error('请输入账号或手机号'));				}				setTimeout(() => {					if (value.length < 2) {						callback(new Error('账号至少2位'));					} else {						callback();					}				}, 500);			};			let validatePass = (rule, value, callback) => {				if (value === '') {					callback(new Error('请输入密码'));				} else if (!checkPass(value)) {					callback(new Error('密码需8~20位，不能为纯数字和纯字母'));				} else {					callback();				}			};			function checkPass(pwd) {				let pwdCheck = /^(?![\d]+$)(?![a-zA-Z]+$)(?![^\da-zA-Z]+$).{8,20}$/;				return pwdCheck.test(pwd);			};			return {				form: {					account: '',					password: '',					delivery: Cookies.getJSON('username') ? true : false				},				cloudChain: {					password: [						{validator: validatePass, trigger: 'change'}					],					account: [						{validator: checkName, trigger: 'change'}					]				},				menus: []			}		},		methods: {			submitForm(formName) {				this.$refs[formName].validate((valid) => {					if (valid) {						this.gologin();					} else {						console.log('error submit!!');						return false;					}				});			},			limitValue(value) {				if (value.length > 11) {					this.form.account = value.slice(0, 11);				}			},			change(value) {				this.form.delivery = value;			},			gologin() {				let params = {};				if (Cookies.get('username') && Cookies.get('pass')) {					params = {						loginName: Cookies.get('username'),						password: Cookies.get('pass')					}				} else {					params = {						loginName: this.form.account,						password: this.form.password					}				}				this.RestClient('CREATE', '/user/login', params).then((res) => {					if (res.data.code == 200) {						this.$store.commit("bindStatus", res.data.data.bindStatus);						this.$store.commit("bindUrl", res.data.data.bindUrl);						this.$store.commit('getUserInfo', {userInfo: res.data.data});						if (res.data.data.isDefaultPassword == true) {							sessionStorage.setItem("isDefaultPassword", res.data.data.isDefaultPassword);						}						if (this.form.delivery == true) {							Cookies.set('username', this.form.account, {expires: 1});							Cookies.set('pass', this.form.password, {expires: 1});						} else {							Cookies.remove('username');							Cookies.remove('pass');						}						sessionStorage.setItem("token", res.headers.authorization);						this.menus = res.data.data.menus;						let menusStr = JSON.stringify(this.menus);						localStorage.setItem("menus", menusStr);						switch (res.data.data.roleType) {							case 2:								this.$router.push('/userAdmin_op');								break;							case 6:								this.$router.push('/walletAdmin');								break;							case 7:								this.$router.push('/walletAdmin');								break;							case 8:								this.$message({									message: '此账号无权登录！',									type: 'info'								});								this.$router.push({									path: '/login'								});								break;							default:								this.$router.push('/')						}					} else {						this.$router.push('/login')					}				})			}		},		beforeRouteEnter: (to, from, next) => {			next(vm => {				if (Cookies.get('username') && Cookies.get('pass')) {					vm.gologin()				} else {					vm.form.delivery = false				}			})		}	}</script><style lang="scss" scoped>  .block {    background: rgb(238, 239, 244);    height: 100%;    display: flex;    align-items: center;    font-size: 14px;    .particle {      position: absolute;      top: 0;      bottom: 0;      left: 0;      right: 0;    }    .loginBox {      z-index: 10;      margin: 0 auto;      width: 490px;      height: 500px;      .logo {        text-align: center;        p {          font-size: 15px;          color: rgb(130, 130, 130);        }      }      .form {        p {          font-size: 16px;          margin-bottom: 15px;        }        width: 80%;        margin: 0 auto;        margin-top: 60px;        button {          width: 100%;        }      }    }    .footer {      position: absolute;      bottom: 0;      left: 0;      right: 0;      color: rgb(124, 125, 128);      text-align: center;      padding-bottom: 15px;    }  }</style>